/**
 * Hipchat Chess v1.0
 * @since   December 2016
 * @author  Fedeirco Sosa (federico.develop@gmail.com)
 */

function startGame(){canvas=document.getElementById("chess"),canvasContext=canvas.getContext("2d"),setInterval(function(){render()},20)}function render(){clearCanvas(),drawMap(),drawPieces()}function clearCanvas(){canvas.width=canvas.width}function drawMap(){for(var a=0;a<8;a++)for(var b=0;b<8;b++)canvasContext.fillStyle=(a+b)%2==0?COLOR_B1:COLOR_B2,canvasContext.fillRect(a*TILE_SIZE,b*TILE_SIZE,TILE_SIZE,TILE_SIZE)}function drawPieces(){for(var a=0;a<8;a++)for(var b=0;b<8;b++)drawPiece(a,b,canvasContext)}function drawPiece(a,b,c){for(var d=0;d<pieces.length;d++)if(pieces[d].x==a&&pieces[d].y==b){var e=a*TILE_SIZE+10,f=b*TILE_SIZE+45;c.font="40px Arial";var g=getPieceType(pieces[d].type,pieces[d].player);c.fillStyle="white"==pieces[d].player?COLOR_P1:COLOR_P2,c.fillText(g,e,f)}}function getPieceType(a,b){var c;switch(a){case"king":c="white"==b?"♔":"♚";break;case"queen":c="white"==b?"♕":"♛";break;case"rook":c="white"==b?"♖":"♜";break;case"bishop":c="white"==b?"♗":"♝";break;case"knight":c="white"==b?"♘":"♞";break;case"pawn":c="white"==b?"♙":"♟"}return c}const TILE_SIZE=64,COLOR_B1="#BB9",COLOR_B2="#252",COLOR_P1="#FFF",COLOR_P2="#000";$(function(){$("#chess").css({backgroundColor:"#DDD"})});var canvas,canvasContext,socket=io.connect("http://localhost:8080"),pieces;socket.on("init",function(a){pieces=JSON.parse(a),startGame()});